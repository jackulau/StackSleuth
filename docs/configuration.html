<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration - StackSleuth</title>
    <link rel="stylesheet" href="css/gitbook.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="icon" type="image/svg+xml" href="logo.svg">
</head>
<body>
    <!-- Mobile Header -->
    <div class="mobile-header">
        <button class="mobile-toggle" id="mobile-toggle">
            <i class="fas fa-bars"></i>
        </button>
        <div class="sidebar-logo">
            <img src="logo.svg" alt="StackSleuth">
            <span>StackSleuth</span>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <div class="gitbook-container">
        <!-- Sidebar -->
        <nav class="gitbook-sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="index.html" class="sidebar-logo">
                    <img src="logo.svg" alt="StackSleuth">
                    <span>StackSleuth</span>
                </a>
            </div>

            <div class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Getting Started</div>
                    <div class="nav-item">
                        <a href="index.html" class="nav-link">
                            <i class="fas fa-home icon"></i>
                            Overview
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="getting-started.html" class="nav-link">
                            <i class="fas fa-rocket icon"></i>
                            Quick Start
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="dashboard.html" class="nav-link">
                            <i class="fas fa-chart-line icon"></i>
                            Dashboard
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Packages</div>
                    <div class="nav-item">
                        <a href="packages.html" class="nav-link">
                            <i class="fas fa-box icon"></i>
                            All Packages
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Examples</div>
                    <div class="nav-item">
                        <a href="examples.html" class="nav-link">
                            <i class="fas fa-book icon"></i>
                            Examples Overview
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="examples-react.html" class="nav-link">
                            <i class="fab fa-react icon"></i>
                            React Examples
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="examples-vue.html" class="nav-link">
                            <i class="fab fa-vuejs icon"></i>
                            Vue Examples
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="examples-node.html" class="nav-link">
                            <i class="fab fa-node-js icon"></i>
                            Node.js Examples
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Documentation</div>
                    <div class="nav-item">
                        <a href="api-reference.html" class="nav-link">
                            <i class="fas fa-code icon"></i>
                            API Reference
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="configuration.html" class="nav-link active">
                            <i class="fas fa-cog icon"></i>
                            Configuration
                        </a>
                    </div>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Resources</div>
                    <div class="nav-item">
                        <a href="https://github.com/Jack-GitHub12/StackSleuth" class="nav-link" target="_blank">
                            <i class="fab fa-github icon"></i>
                            GitHub Repository
                        </a>
                    </div>
                    <div class="nav-item">
                        <a href="https://www.npmjs.com/org/stacksleuth" class="nav-link" target="_blank">
                            <i class="fab fa-npm icon"></i>
                            NPM Packages
                        </a>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="gitbook-content">
            <!-- Header -->
            <header class="gitbook-header">
                <div class="breadcrumb">
                    <i class="fas fa-home"></i>
                    <span>Documentation</span>
                    <span>/</span>
                    <span>Configuration</span>
                </div>
                <div class="actions">
                    <div class="header-search">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" placeholder="Search documentation..." id="header-search">
                    </div>
                    <a href="https://github.com/Jack-GitHub12/StackSleuth" target="_blank" class="btn btn-secondary">
                        <i class="fab fa-github"></i>
                        GitHub
                    </a>
                </div>
            </header>

            <!-- Scroll Indicator -->
            <div class="scroll-indicator">
                <div class="scroll-progress" id="scroll-progress"></div>
            </div>

            <!-- Content -->
            <div class="content-wrapper">
                <div class="content-header">
                    <h1 class="content-title">Configuration Guide</h1>
                    <p class="content-subtitle">Learn how to configure StackSleuth for optimal performance monitoring in your application.</p>
                </div>

                <section id="core-options">
                    <h2>Core Configuration Options</h2>
                    <p>All StackSleuth agents share these core configuration options:</p>

                    <table class="config-table">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Type</th>
                                <th>Default</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>enabled</code></td>
                                <td>boolean</td>
                                <td>true</td>
                                <td>Enable or disable the agent</td>
                            </tr>
                            <tr>
                                <td><code>projectId</code></td>
                                <td>string</td>
                                <td>required</td>
                                <td>Unique identifier for your project</td>
                            </tr>
                            <tr>
                                <td><code>apiKey</code></td>
                                <td>string</td>
                                <td>null</td>
                                <td>API key for authentication (required for cloud-hosted)</td>
                            </tr>
                            <tr>
                                <td><code>apiEndpoint</code></td>
                                <td>string</td>
                                <td>'http://localhost:3000'</td>
                                <td>StackSleuth API endpoint</td>
                            </tr>
                            <tr>
                                <td><code>sampleRate</code></td>
                                <td>number</td>
                                <td>1.0</td>
                                <td>Percentage of requests to monitor (0.0-1.0)</td>
                            </tr>
                            <tr>
                                <td><code>enableTracing</code></td>
                                <td>boolean</td>
                                <td>true</td>
                                <td>Enable distributed tracing</td>
                            </tr>
                            <tr>
                                <td><code>enableMetrics</code></td>
                                <td>boolean</td>
                                <td>true</td>
                                <td>Enable performance metrics collection</td>
                            </tr>
                            <tr>
                                <td><code>enableProfiling</code></td>
                                <td>boolean</td>
                                <td>false</td>
                                <td>Enable CPU/memory profiling (higher overhead)</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <section id="backend-config">
                    <h2>Backend Agent Configuration</h2>
                    <p>Additional options for backend monitoring:</p>

                    <pre class="language-javascript"><code>const agent = new BackendAgent({
    // Core options
    enabled: true,
    projectId: 'my-backend-app',

    // Backend-specific options
    middleware: {
        captureBody: true,        // Capture request/response bodies
        captureHeaders: true,     // Capture HTTP headers
        redactKeys: ['password', 'token', 'secret'], // Redact sensitive data
        ignoreRoutes: ['/health', '/metrics'],       // Routes to ignore
        ignoreUserAgents: ['bot', 'crawler']         // User agents to ignore
    },

    // Database monitoring
    database: {
        captureQueries: true,     // Log database queries
        slowQueryThreshold: 100,  // Mark queries slower than 100ms
        explainSlowQueries: true  // Run EXPLAIN on slow queries
    },

    // Custom metadata
    metadata: {
        environment: 'production',
        region: 'us-west-2',
        version: '1.2.3'
    }
});</code></pre>

                    <div class="callout info">
                        <div class="callout-title">Tip</div>
                        <p>Use environment variables for sensitive configuration:</p>
                        <pre class="language-javascript"><code>apiKey: process.env.STACKSLEUTH_API_KEY</code></pre>
                    </div>
                </section>

                <section id="frontend-config">
                    <h2>Frontend Agent Configuration</h2>
                    <p>Options specific to browser monitoring:</p>

                    <pre class="language-javascript"><code>const agent = new FrontendAgent({
    // Core options
    enabled: true,
    projectId: 'my-frontend-app',

    // Frontend-specific options
    performance: {
        trackResources: true,     // Track resource loading times
        trackLongTasks: true,     // Track tasks > 50ms
        trackFCP: true,           // First Contentful Paint
        trackLCP: true,           // Largest Contentful Paint
        trackCLS: true,           // Cumulative Layout Shift
        trackFID: true,           // First Input Delay
        trackTTFB: true           // Time to First Byte
    },

    // Error tracking
    errors: {
        captureErrors: true,      // Capture JavaScript errors
        capturePromiseRejections: true,
        ignoreErrors: ['ResizeObserver', 'Network request failed'],
        beforeSend: (error) => {
            // Filter or modify errors before sending
            if (error.message.includes('test')) return null;
            return error;
        }
    },

    // User tracking
    user: {
        trackClicks: true,        // Track user clicks
        trackScrolls: true,       // Track scroll depth
        trackSessions: true,      // Track user sessions
        anonymizeIP: true         // Anonymize IP addresses
    }
});</code></pre>

                    <div class="callout warning">
                        <div class="callout-title">Privacy Notice</div>
                        <p>Always inform users about monitoring and comply with privacy regulations (GDPR, CCPA).</p>
                    </div>
                </section>

                <section id="database-config">
                    <h2>Database Agent Configuration</h2>
                    <p>Configure database-specific monitoring:</p>

                    <h3>MongoDB Agent</h3>
                    <pre class="language-javascript"><code>const mongoAgent = new MongoDBAgent({
    connectionString: 'mongodb://localhost:27017',
    projectId: 'my-app',

    // MongoDB-specific options
    profiling: {
        slowOpThreshold: 100,     // Log operations > 100ms
        sampleRate: 0.1,          // Sample 10% of operations
        captureFullQuery: false   // Redact query values
    },

    collections: {
        ignore: ['sessions', 'logs'], // Collections to ignore
        indexAnalysis: true           // Analyze index usage
    }
});</code></pre>

                    <h3>Redis Agent</h3>
                    <pre class="language-javascript"><code>const redisAgent = new RedisAgent({
    host: 'localhost',
    port: 6379,
    projectId: 'my-app',

    // Redis-specific options
    monitoring: {
        trackKeyPatterns: true,   // Track key access patterns
        trackMemoryUsage: true,   // Monitor memory consumption
        slowLogThreshold: 10      // Commands slower than 10ms
    }
});</code></pre>

                    <h3>MySQL Agent</h3>
                    <pre class="language-javascript"><code>const mysqlAgent = new MySQLAgent({
    host: 'localhost',
    user: 'monitoring',
    password: process.env.DB_PASSWORD,
    projectId: 'my-app',

    // MySQL-specific options
    monitoring: {
        slowQueryLog: true,       // Enable slow query logging
        slowQueryThreshold: 100,  // Queries slower than 100ms
        explainPlan: true,        // Get execution plans
        indexUsage: true          // Track index effectiveness
    }
});</code></pre>
                </section>

                <section id="environment-config">
                    <h2>Environment-Specific Configuration</h2>
                    <p>Configure StackSleuth differently for each environment:</p>

                    <pre class="language-javascript"><code>// config/stacksleuth.js
const configs = {
    development: {
        enabled: true,
        sampleRate: 1.0,          // Monitor all requests in dev
        apiEndpoint: 'http://localhost:3000',
        enableProfiling: true     // Enable profiling in dev
    },

    staging: {
        enabled: true,
        sampleRate: 0.5,          // Monitor 50% in staging
        apiEndpoint: 'https://staging-api.stacksleuth.com',
        enableProfiling: false
    },

    production: {
        enabled: true,
        sampleRate: 0.1,          // Monitor 10% in production
        apiEndpoint: 'https://api.stacksleuth.com',
        enableProfiling: false,
        apiKey: process.env.STACKSLEUTH_API_KEY
    }
};

export default configs[process.env.NODE_ENV || 'development'];</code></pre>
                </section>

                <section id="thresholds">
                    <h2>Performance Thresholds</h2>
                    <p>Set custom thresholds for performance monitoring:</p>

                    <pre class="language-javascript"><code>const agent = new BackendAgent({
    projectId: 'my-app',

    thresholds: {
        // Response time thresholds (ms)
        responseTime: {
            good: 200,      // < 200ms is good
            warning: 1000,  // 200-1000ms is warning
            critical: 3000  // > 3000ms is critical
        },

        // Error rate thresholds (percentage)
        errorRate: {
            good: 0.01,     // < 1% is good
            warning: 0.05,  // 1-5% is warning
            critical: 0.10  // > 10% is critical
        },

        // Database query thresholds (ms)
        databaseQuery: {
            good: 50,
            warning: 200,
            critical: 1000
        },

        // Memory usage thresholds (MB)
        memoryUsage: {
            good: 256,
            warning: 512,
            critical: 1024
        }
    }
});</code></pre>
                </section>

                <section id="advanced-config">
                    <h2>Advanced Configuration</h2>

                    <h3>Custom Reporters</h3>
                    <pre class="language-javascript"><code>class CustomReporter {
    async report(metrics) {
        // Send metrics to custom endpoint
        await fetch('https://my-metrics-service.com', {
            method: 'POST',
            body: JSON.stringify(metrics)
        });
    }
}

const agent = new BackendAgent({
    projectId: 'my-app',
    reporters: [
        new CustomReporter(),
        new ConsoleReporter({ pretty: true })
    ]
});</code></pre>

                    <h3>Sampling Strategies</h3>
                    <pre class="language-javascript"><code>// Adaptive sampling based on traffic
const agent = new BackendAgent({
    projectId: 'my-app',
    sampling: {
        type: 'adaptive',
        baseRate: 0.01,           // 1% baseline
        peakRate: 0.10,           // 10% during peaks
        errorRate: 1.0,           // 100% for errors
        slowRequestRate: 0.50     // 50% for slow requests
    }
});</code></pre>

                    <h3>Custom Instrumentation</h3>
                    <pre class="language-javascript"><code>// Add custom timers
agent.startTimer('custom-operation');
// ... perform operation ...
agent.endTimer('custom-operation');

// Add custom metrics
agent.recordMetric('cache.hit.rate', 0.95);
agent.recordMetric('queue.length', 42);

// Add custom spans
const span = agent.startSpan('process-payment');
try {
    // ... process payment ...
    span.setTag('amount', 99.99);
    span.setTag('currency', 'USD');
} finally {
    span.finish();
}</code></pre>
                </section>

                <section id="best-practices">
                    <h2>Configuration Best Practices</h2>

                    <ol>
                        <li><strong>Start Conservative:</strong> Begin with low sample rates and increase as needed</li>
                        <li><strong>Use Environment Variables:</strong> Never hardcode sensitive values</li>
                        <li><strong>Monitor Overhead:</strong> Check the performance impact of monitoring</li>
                        <li><strong>Redact Sensitive Data:</strong> Configure proper data redaction rules</li>
                        <li><strong>Test Configuration:</strong> Validate config changes in staging first</li>
                        <li><strong>Document Changes:</strong> Keep a changelog of configuration updates</li>
                        <li><strong>Regular Review:</strong> Periodically review and optimize settings</li>
                    </ol>

                    <div class="callout success">
                        <div class="callout-title">Configuration Validation</div>
                        <p>StackSleuth validates configuration on startup and logs warnings for invalid settings.</p>
                    </div>
                </section>

                <!-- Footer Navigation -->
                <div class="content-footer">
                    <a href="api-reference.html" class="footer-nav footer-nav-prev">
                        <i class="fas fa-arrow-left icon"></i>
                        <span>Previous: API Reference</span>
                    </a>
                    <a href="examples.html" class="footer-nav">
                        <span>Next: Examples</span>
                        <i class="fas fa-arrow-right icon"></i>
                    </a>
                </div>
            </div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="js/gitbook.js"></script>
</body>
</html>
